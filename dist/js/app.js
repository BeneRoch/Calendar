"undefined"!=typeof jQuery&&function(t){t.fn.calendar=function(e,a){var s=t(this).data("calendar");if(s){if("string"==typeof e)switch(e){case"destroy":s.destroy();break;case"next":s.changeMonth(1);break;case"prev":s.changeMonth(-1);break;case"addEvent":a&&s.addEvent(a);break;case"addEvents":a&&s.addEvents(a);break;case"setEvents":a&&s.setEvents(a);break;case"events":a&&(s.opts.events=a,s.loadEvents(),s.load())}return s}target=t(this).get(0),calendar=new bCalendar(target,e)}}(jQuery);var bCalendar=function(t,e){let a=bCalendar.Utils.extend(!0,bCalendar.defaults,e);return this.target=t,this._strings,"year"===a.mode&&(a.allowYearView=!0),"month"===a.mode&&(a.allowMonthView=!0),this.opts=a,this.lang="string"==typeof a.lang?a.lang:"fr",this.aMonths=a.translations.months,this.aDays=a.translations.days,this.events={},this.setStartDate(a.startDate),this.showStartDate=a.showStartDate,void 0!==a.selectedDate&&this.setSelectedDate(a.startDate),this.loadEvents(),this.month=this.startDate.getMonth(),this.year=this.startDate.getFullYear(),this.html="",this.load(),this};bCalendar.prototype.strings=function(){if(this._strings)return this._strings;var t=this.opts.classes;return t=bCalendar.Utils.extend(t,{prevYearLabel:this.opts.translations.prevYearLabel[this.lang],nextYearLabel:this.opts.translations.nextYearLabel[this.lang],nextMonthLabel:this.opts.translations.nextMonthLabel[this.lang],prevMonthLabel:this.opts.translations.prevMonthLabel[this.lang]}),this._strings=t,this._strings},bCalendar.prototype.load=function(){var t=this.opts;return this.opts=t,this.generateHTML(),this.target.innerHTML=this.getHTML(),dataStorage.put(this.target,"bCalendar",this),this.addListeners(),this},bCalendar.prototype.addEvents=function(t){if("object"!=typeof event)return!1;if(!t.length)return!1;for(var e=t.length,a=0;a<e;a++)this.addEvent(t[a]);return this},bCalendar.prototype.addEvent=function(t){return"object"==typeof t&&(void 0===this.opts.events&&(this.opts.events=[]),"object"!=typeof this.opts.events&&(this.opts.events=[]),this.opts.events.push(t),this.setEvents(this.opts.events),this)},bCalendar.prototype.setEvents=function(t){return"object"==typeof t&&(this.opts.events=t,this.loadEvents(),this.refresh(),this)},bCalendar.prototype.loadEvents=function(){this.singleEvents={},this.events={},this.numEvents={};var t=this.opts;if("object"!=typeof t.events)return!1;for(var e=0;e<t.events.length;e++){var a,s;"object"==typeof t.events[e].date?(a=new Date(this.unescapeDatas(t.events[e].date.start)),s=new Date(this.unescapeDatas(t.events[e].date.end))):s=a=new Date(this.unescapeDatas(t.events[e].date));var n=a,r=n.getFullYear(),o=n.getMonth();this._buildEventsSkeleton(r,o),this.numEvents[r].num++,this.numEvents[r].months[o].num++,this.singleEvents[r].months[o].push(t.events[e]);for(var i=o,l=r;n<=s;){r=n.getFullYear(),o=n.getMonth();var h=n.getDate();this._buildEventsSkeleton(r,o),void 0===this.events[r][o][h]&&(this.events[r][o][h]=[]),this.events[r][o][h].push(t.events[e]),void 0===this.numEvents[r].months[o].days[h]&&(this.numEvents[r].months[o].days[h]=0),this.numEvents[r].months[o].days[h]++,l!==r&&this.numEvents[r].num++,i!==o&&(this.numEvents[r].months[o].num++,this.singleEvents[r].months[o].push(t.events[e])),n=new Date(r,o,h+1),i=o,l=r}}return this},bCalendar.prototype.getEventsByDate=function(t){t instanceof Date||(t=new Date(t));var e=t.getMonth(),a=t.getFullYear(),s=t.getDate();return void 0===this.events[a]||void 0===this.events[a][e]||void 0===this.events[a][e][s]?{}:this.events[a][e][s]},bCalendar.prototype.getEventsByMonth=function(t){t instanceof Date||(t=new Date(t));var e=t.getMonth(),a=t.getFullYear();return void 0===this.singleEvents[a]||void 0===this.singleEvents[a].months[e]?{}:this.singleEvents[a].months[e]},bCalendar.prototype.changeMonth=function(t){var e=void 0===t||t>0?1:-1;return 0===this.month&&-1===e||11===this.month&&1===e?(this.year+=e,this.month+=-11*e):this.month+=e,this.refresh(this.opts.callbacks.onChangeMonth),this},bCalendar.prototype.changeYear=function(t){return this.year=this.year+t,this.refresh(this.opts.callbacks.onChangeYear),this},bCalendar.prototype.goToDate=function(t){return t instanceof Date||(t=new Date(t)),this.month=t.getMonth(),this.year=t.getFullYear(),this.refresh(),this},bCalendar.prototype.setStartDate=function(t){return t instanceof Date||(t=new Date(t)),this.startDate=t,this},bCalendar.prototype.setSelectedDate=function(t){return t instanceof Date||(t=new Date(t)),this.selectedDate=t,this.opts.callbacks.onDatePick(t,this),this},bCalendar.prototype.destroy=function(){this.removeListeners(),this.target.innerHTML="",dataStorage.remove(this.target,"bCalendar",this)},bCalendar.prototype.getNumEvents=function(t,e){t instanceof Date||(t=new Date(t));var a=t.getFullYear();if(void 0===this.numEvents[a])return 0;if("year"===e)return this.numEvents[a].num;var s=t.getMonth();if(void 0===this.numEvents[a].months[s])return 0;if("month"===e)return this.numEvents[a].months[s].num;var n=t.getDate();return void 0===this.numEvents[a].months[s].days[n]?0:this.numEvents[a].months[s].days[n]},bCalendar.defaults={startDate:new Date,showStartDate:!0,lang:"fr",mode:"month",allowYearView:!1,allowMonthView:!0,useControls:!0,displayEventsNumber:!0,eventsNumberTemplate:'<span class="c-calendar_num">{num}</span>',displayAdjacentMonthDates:!0,events:{},classes:{mainCalendarClass:"c-calendar",calendarTitleClass:"c-calendar_title",calendarTitleMonthClass:"c-calendar_title_month",calendarTitleYearClass:"c-calendar_title_year",calendarControlsClass:"c-calendar_controls",calendarControlsPrevClass:"c-calendar_prev",calendarControlsNextClass:"c-calendar_next",calendarControlsHtml:"",calendarTableClass:"c-calendar_table",calendarTableHeaderClass:"c-calendar_header",calendarRowClass:"c-calendar_row",calendarDayClass:"c-calendar_day",calendarMonthClass:"c-calendar_month",calendarMonthLabelClass:"c-calendar_month_label",calendarLinkClass:"c-calendar_link",calendarTextClass:"c-calendar_text",calendarEventClass:"-event",calendarCurrentDayClass:"-today",calendarSelectedDayClass:"-selected",calendarSelectedMonthClass:"-selected",calendarEmptyDayClass:"-empty"},callbacks:{onChangeMonth:function(t){},onChangeYear:function(t){},onDatePick:function(t,e){},onMonthSelect:function(t,e){},onMonthEventSelect:function(t,e){},onDayClick:function(t,e){},onEventClick:function(t,e){},onDayMouseover:function(t,e){},onEventMouseover:function(t,e){},onDayMouseout:function(t,e){},onEventMouseout:function(t,e){},onPrev:function(t){},onNext:function(t){},onPrevYear:function(t){},onNextYear:function(t){},onGotoMonthView:function(t){},onGotoDateView:function(t){}},translations:{months:{fr:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],en:["January","February","March","April","May","June","July","August","September","October","November","December"]},days:{fr:["D","L","M","M","J","V","S"],en:["S","M","T","W","T","F","S"]},nextMonthLabel:{en:"Next Month",fr:"Mois suivant"},prevMonthLabel:{en:"Previous Month",fr:"Mois précédent"},nextYearLabel:{en:"Next Year",fr:"Année suivante"},prevYearLabel:{en:"Previous Year",fr:"Année précédente"}},eventSeparator:"{|}"},bCalendar.prototype.removeListeners=function(){},bCalendar.prototype.addListeners=function(){var t=this.opts;return this.target.addEventListener("click",(e=>{var a=e.target.closest("."+t.classes.calendarDayClass);if(a){e.preventDefault(),e.stopPropagation();var s=this.unescapeDatas(this._eventDatas(a));this.setSelectedDate(s.date),this.refresh(),t.callbacks.onDayClick(s,this)}var n=e.target.closest("."+t.classes.calendarEventClass+"."+t.classes.calendarDayClass);n&&(e.preventDefault(),e.stopPropagation(),s=this.unescapeDatas(this._eventDatas(n)),t.callbacks.onEventClick(s,this)),e.target.closest("."+t.classes.calendarControlsPrevClass)&&(e.preventDefault(),e.stopPropagation(),"month"===t.mode&&(t.callbacks.onPrev(this),this.changeMonth(-1)),"year"===t.mode&&(this.changeYear(-1),t.callbacks.onPrevYear(this))),e.target.closest("."+t.classes.calendarControlsNextClass)&&(e.preventDefault(),e.stopPropagation(),"month"===t.mode&&(t.callbacks.onNext(this),this.changeMonth(1)),"year"===t.mode&&(this.changeYear(1),t.callbacks.onNextYear(this))),e.target.closest("."+t.classes.calendarMonthLabelClass)&&(e.preventDefault(),e.stopPropagation(),this.opts.allowYearView&&(this.opts.mode="year",t.callbacks.onGotoMonthView(this),this.refresh()));var r=e.target.closest("."+t.classes.calendarMonthClass);if(r){e.preventDefault(),e.stopPropagation();var o=new Date(r.dataset.date);this.opts.allowMonthView?(this.opts.mode="month",this.month=o.getMonth(),this.year=o.getFullYear(),t.callbacks.onGotoDateView(o,this)):(t.callbacks.onMonthSelect(o,this),this.setSelectedDate(o)),this.refresh()}var i=e.target.closest("."+t.classes.calendarMonthClass+"."+t.classes.calendarEventClass);if(i){e.preventDefault(),e.stopPropagation(),o=new Date(i.dataset.date);var l=this.unescapeDatas(this.getEventsByMonth(o));t.callbacks.onMonthEventSelect(l,this)}})),this.target.addEventListener("mouseenter",(e=>{var a=e.target.closest("."+t.classes.calendarDayClass);if(a){e.preventDefault();var s=this.unescapeDatas(this._eventDatas(a));t.callbacks.onDayMouseover(s,this)}var n=e.target.closest("."+t.classes.calendarEventClass+"."+t.classes.calendarDayClass);n&&(e.preventDefault(),s=this.unescapeDatas(this._eventDatas(n)),t.callbacks.onEventMouseover(s,this))})),this.target.addEventListener("mouseout",(e=>{var a=e.target.closest("."+t.classes.calendarEventClass+"."+t.classes.calendarDayClass);if(a){e.preventDefault();var s=this.unescapeDatas(this._eventDatas(a));t.callbacks.onEventMouseout(s,this)}var n=e.target.closest("."+t.classes.calendarDayClass);n&&(e.preventDefault(),s=this.unescapeDatas(this._eventDatas(n)),t.callbacks.onDayMouseout(s,this))})),this},bCalendar.prototype.generateHTML=function(){var t=this.opts.mode;switch(this.opts.events=this.escapeDatas(this.opts.events),t){case"year":return this.generateMonthView();case"month":return this.generateDateView()}return""},bCalendar.prototype.getHTML=function(){return this.html},bCalendar.prototype.generateMonthView=function(){var t=this.strings();t.year=this.year;var e=this.opts,a=new Date(this.year,this.month,1),s=e.translations.months[e.lang],n="";n+='<div class="{mainCalendarClass}">';var r=this.getNumEvents(a,"year");if(e.displayEventsNumber&&0!=r){var o=e.eventsNumberTemplate.strtr({num:r});n+='<p class="{calendarTitleClass}">{year}'+o+"</p>"}else n+='<p class="{calendarTitleClass}">{year}</p>';e.useControls&&(n+='<div class="{calendarControlsClass}"><button class="{calendarControlsPrevClass}" type="button">{prevYearLabel}</button><button class="{calendarControlsNextClass}" type="button">{nextYearLabel}</button></div>'),n+='<table class="{calendarTableClass}">';for(var i=0;i<3;i++){n+='<tr class="{calendarRowClass}">';for(var l=0;l<=3;l++){var h=parseInt(4*i+l),c=s[h],d=new Date(this.year+"/"+(h+1)+"/1"),v=this.getEventsByMonth(this.year+"/"+(h+1)+"/1"),u=bCalendar.Utils.isEmpty(v)?"":" {calendarEventClass}",p="";this.selectedDate instanceof Date&&this.selectedDate.getMonth()===h&&this.selectedDate.getFullYear()===this.year&&(u+=" {calendarSelectedMonthClass}"),r=this.getNumEvents(d,"month"),e.displayEventsNumber&&(p+=' data-num="'+r+'"'),n+='<td class="{calendarMonthClass}'+u+'"'+p+' data-date="'+this.year+"/"+(h+1)+'/1">   <button class="{calendarLinkClass}"><span class="{calendarTextClass}">',n+=c,n+="</span>",e.displayEventsNumber&&0!==r&&(n+=o=e.eventsNumberTemplate.strtr({num:r})),n+="</button></td>"}n+="</tr>"}return n+="</tr></table></div>",this.html=n.strtr(t),this},bCalendar.prototype.generateDateView=function(){var t=this.strings(),e=this.opts,a=new Date(this.year,this.month,1),s=a.getDay(),n=a.getLastDayOfMonth(),r=this.month-1;r<0&&(r=11);var o=new Date(this.year,r,1).getLastDayOfMonth()-(s-1);t.monthName=this.aMonths[this.lang][this.month],t.year=this.year;var i='<div class="{mainCalendarClass}"><p class="{calendarTitleClass}"><button href="#" class="{calendarMonthLabelClass}"><span class="{calendarTitleMonthClass}">{monthName} </span><span class="{calendarTitleYearClass}">{year}</span></button></p>';e.useControls&&(i+='<div class="{calendarControlsClass}"><button class="{calendarControlsPrevClass}" type="button">{prevMonthLabel}</button><button class="{calendarControlsNextClass}" type="button">{nextMonthLabel}</button></div>'),i+='<table class="{calendarTableClass}"><thead class="{calendarTableHeaderClass}"><tr class="{calendarRowClass}">';for(var l=0;l<=6;l++)i+='<th class="{calendarDayClass}"><span class="{calendarTextClass}">',i+=this.aDays[this.lang][l],i+="</span></th>";i+='</tr></thead></tr><tbody><tr class="{calendarRowClass}">';for(var h=1,c=1,d=0;d<9;d++){for(var v=0;v<=6;v++){var u=new Date(this.year,this.month,h),p=h<=n&&(d>0||v>=s),g=p?this.year+"/"+(this.month+1)+"/"+h:0,b={};if(0===d&&v<s)r=0===this.month?12:this.month,g=this.year+"/"+r+"/"+o,b=this.getEventsByDate(g);else if(!p&&d>0){var y=this.month>=11?1:this.month+2;g=this.year+"/"+y+"/"+c,b=this.getEventsByDate(g)}else b=this.getEventsByDate(u);var f=bCalendar.Utils.isEmpty(b)?"":" {calendarEventClass}";this.showStartDate&&this.startDate.getFullYear()===this.year&&this.startDate.getMonth()===this.month&&this.startDate.getDate()===h&&p&&(f+=" {calendarCurrentDayClass}"),this.selectedDate instanceof Date&&this.selectedDate.getFullYear()===this.year&&this.selectedDate.getMonth()===this.month&&this.selectedDate.getDate()===h&&p&&(f+=" {calendarSelectedDayClass}"),i+='<td class="{calendarDayClass}'+(p?"":" {calendarEmptyDayClass}")+f+'" data-date="'+g+'">',i+='<button class="{calendarLinkClass}">',p?(i+=h,h++):0===d?(e.displayAdjacentMonthDates&&(i+=o),o++):(i+=c,c++);var D=this.getNumEvents(u);e.displayEventsNumber&&0!==D&&p&&(i+=e.eventsNumberTemplate.strtr({num:D})),i+="</button>",i+="</td>"}if(h>n)break;i+='</tr><tr class="{calendarRowClass}">'}return i+="</tr></tbody></table></div>",this.html=i.strtr(t),this},bCalendar.prototype.refresh=function(t){return this.generateHTML(),this.target.innerHTML=this.getHTML(),"function"==typeof t&&t(this),this},bCalendar.prototype.strings=function(){if(this._strings)return this._strings;var t=this.opts.classes;return t=bCalendar.Utils.extend(t,{prevYearLabel:this.opts.translations.prevYearLabel[this.lang],nextYearLabel:this.opts.translations.nextYearLabel[this.lang],nextMonthLabel:this.opts.translations.nextMonthLabel[this.lang],prevMonthLabel:this.opts.translations.prevMonthLabel[this.lang]}),this._strings=t,this._strings},bCalendar.prototype._buildEventsSkeleton=function(t,e){return void 0===this.events[t]&&(this.events[t]={}),void 0===this.events[t][e]&&(this.events[t][e]={}),void 0===this.numEvents[t]&&(this.numEvents[t]={num:0,months:{}}),void 0===this.numEvents[t].months[e]&&(this.numEvents[t].months[e]={num:0,days:{}}),void 0===this.singleEvents[t]&&(this.singleEvents[t]={months:{}}),void 0===this.singleEvents[t].months[e]&&(this.singleEvents[t].months[e]=[]),this},bCalendar.prototype.escapeDatas=function(t){if(void 0===t)return"";if("array"==typeof t)for(var e=0,a=t.length;e<a;e++)t[e]=this.escapeDatas(t[e]);if("object"==typeof t)for(var e in t)t[e]=this.escapeDatas(t[e]);return"string"==typeof t?(t=this.unescapeDatas(t),escape(t)):t},bCalendar.prototype.unescapeDatas=function(t){if(void 0===t)return"";if("object"==typeof t)for(var e in t)t[e]=this.unescapeDatas(t[e]);return"string"==typeof t?unescape(t):t},bCalendar.prototype._eventDatas=function(t){var e=t.dataset.date;return e?{date:e=new Date(e),events:this.getEventsByDate(e)}:{date:null,events:[]}},void 0===String.prototype.strtr&&(String.prototype.strtr=function(t){var e,a,s=this.toString();for(e in t)t.hasOwnProperty(e)&&(a=new RegExp("{"+e+"}","g"),s=s.replace(a,t[e]));return s}),void 0===Date.prototype.getLastDayOfMonth&&(Date.prototype.getLastDayOfMonth=function(t){return t?(t instanceof Date||(t=new Date(t)),new Date(t.getYear(),t.getMonth()+1,0).getDate()):new Date(this.getYear(),this.getMonth()+1,0).getDate()}),bCalendar.Utils={extend:function(){var t={},e=!1,a=0,s=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(e=arguments[0],a++);for(var n=function(a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e&&"[object Object]"===Object.prototype.toString.call(a[s])?t[s]=bCalendar.Utils.extend(!0,t[s],a[s]):t[s]=a[s])};a<s;a++)n(arguments[a]);return t},isEmpty:function(t){return t.constructor===String||t.constructor===Array?0===t.length:0===Object.keys(t).length&&t.constructor===Object}},window.dataStorage={_storage:new WeakMap,put:function(t,e,a){this._storage.has(t)||this._storage.set(t,new Map),this._storage.get(t).set(e,a)},get:function(t,e){return this._storage.get(t).get(e)},has:function(t,e){return this._storage.has(t)&&this._storage.get(t).has(e)},remove:function(t,e){var a=this._storage.get(t).delete(e);return 0===!this._storage.get(t).size&&this._storage.delete(t),a}},window.bCalendar=bCalendar;